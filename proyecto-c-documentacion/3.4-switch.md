# 3.4. switch

La proposición `switch` es una herramienta de control de flujo que permite seleccionar una de varias rutas de ejecución basándose en el valor de una única expresión. Es una alternativa más limpia y, a menudo, más eficiente a una larga cadena de `if-else if` cuando todas las comparaciones se hacen contra la misma variable.

## Sintaxis y Componentes

La estructura de un `switch` es la siguiente:

```c
switch (expresion_entera) {
    case constante_1:
        // bloque de código 1
        break;
    case constante_2:
        // bloque de código 2
        break;
    // ... más casos ...
    default:
        // bloque de código por defecto
        break;
}
```

**Componentes clave:**

1.  **`switch (expresion_entera)`**: La expresión dentro del `switch` debe evaluarse a un valor de tipo **entero** (`int`, `char`, `short`, `long`, etc.). No se pueden usar `float`, `double` o cadenas de caracteres aquí.
2.  **`case constante_n:`**: Cada `case` está etiquetado con un valor **constante** y único de tipo entero. No puede ser una variable. El valor de la `expresion_entera` se compara con cada una de estas constantes.
3.  **`break;`**: Esta proposición es crucial. Cuando se encuentra un `break`, la ejecución salta inmediatamente al final del bloque `switch`. Si se omite, ocurre un fenómeno llamado "fall-through".
4.  **`default:`**: Esta etiqueta es opcional. Su bloque de código se ejecuta si el valor de la `expresion_entera` no coincide con ninguna de las constantes de los `case`.

## El Fenómeno "Fall-Through" (Caída)

Una de las características más importantes (y a veces peligrosas) del `switch` en C es el "fall-through". Si omites la proposición `break` en un `case`, la ejecución continuará ("caerá") en el siguiente `case` y ejecutará su código, independientemente de si la constante de ese `case` coincide o no.

**Ejemplo sin `break`:**

```c
int dia = 2;
switch (dia) {
    case 1:
        printf("Lunes\n");
    case 2:
        printf("Martes\n"); // La ejecución comienza aquí
    case 3:
        printf("Miércoles\n"); // Y continúa aquí...
    default:
        printf("No es un día válido\n"); // Y aquí...
}
```

**Salida:**

```
Martes
Miércoles
No es un día válido
```

Este comportamiento puede ser una fuente de errores difíciles de encontrar. **Regla general: termina siempre cada `case` con un `break` a menos que desees intencionadamente el comportamiento de "fall-through".**

El "fall-through" puede ser útil para agrupar casos que deben ejecutar el mismo código:

```c
char vocal = 'i';
switch (vocal) {
    case 'a':
    case 'e':
    case 'i':
    case 'o':
    case 'u':
        printf("Es una vocal minúscula.\n");
        break;
    default:
        printf("No es una vocal minúscula.\n");
        break;
}
```

## `switch` vs. `if-else if`

| Característica   | `switch`                                                                                       | `if-else if`                                                                  |
| :--------------- | :--------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------- |
| **Condición**    | Compara una única variable entera contra constantes.                                           | Puede evaluar expresiones booleanas complejas y diferentes en cada paso.      |
| **Legibilidad**  | Muy claro para una lista de valores discretos.                                                 | Puede volverse complejo y anidado.                                            |
| **Eficiencia**   | Potencialmente más rápido. El compilador puede optimizarlo a una tabla de saltos (jump table). | Evalúa las condiciones secuencialmente.                                       |
| **Flexibilidad** | Menos flexible. Limitado a tipos enteros.                                                      | Muy flexible. Puede comparar rangos (`nota > 90`), diferentes variables, etc. |

**Cuándo usar `switch`:** Cuando tienes una sola variable que puede tomar uno de varios valores discretos y quieres realizar una acción diferente para cada uno.

## Comparación con JavaScript

La proposición `switch` en JavaScript es muy similar a la de C, con algunas diferencias clave:

- **Sintaxis:** La estructura `switch`, `case`, `break`, y `default` es idéntica.
- **Fall-Through:** El comportamiento de "fall-through" si se omite `break` es el mismo.
- **Tipo de Comparación:** Aquí está la gran diferencia. C usa una comparación de igualdad simple. JavaScript usa una **comparación estricta (`===`)**. Esto significa que no solo el valor debe coincidir, sino también el tipo.
- **Tipo de Expresión:** En JavaScript, la expresión en el `switch` y las constantes en los `case` pueden ser de cualquier tipo (números, cadenas, etc.), no solo enteros.

## Resumen

- `switch` es una herramienta eficiente para la selección multi-vía basada en el valor de una única variable entera.
- La proposición `break` es esencial para evitar el comportamiento de "fall-through".
- El "fall-through" intencional puede ser útil para agrupar casos.
- `default` maneja todos los casos no especificados.
- Es menos flexible que `if-else if`, pero más limpio y a menudo más rápido para su caso de uso específico.

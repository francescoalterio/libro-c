# 7.8.7. Generación de Números Pseudoaleatorios (`<stdlib.h>`)

La capacidad de generar números aleatorios es fundamental para una amplia gama de aplicaciones, incluyendo simulaciones, juegos, criptografía y pruebas de software. La biblioteca estándar de C, a través de `<stdlib.h>`, proporciona un conjunto de funciones para generar secuencias de números **pseudoaleatorios**.

Es importante entender el término "pseudoaleatorio": los números no son verdaderamente aleatorios, sino que se generan a partir de un algoritmo determinista. El algoritmo produce una secuencia que parece aleatoria, pero que está completamente determinada por un valor inicial llamado **semilla (seed)**. Si se utiliza la misma semilla, se generará siempre la misma secuencia de números.

## Las Funciones `rand()` y `srand()`

### `srand()`: Inicializar la Semilla

`void srand(unsigned int seed);`

- Esta función inicializa el generador de números pseudoaleatorios con el valor `seed`.
- Para que la secuencia de números sea diferente cada vez que se ejecuta el programa, se debe usar una semilla diferente en cada ejecución.
- La práctica más común es usar la hora actual del sistema como semilla, ya que es un valor que cambia constantemente. La función `time(NULL)` de `<time.h>` devuelve el número de segundos transcurridos desde una época determinada, lo que la hace ideal para este propósito.
- **`srand()` solo debe ser llamada una vez** en todo el programa, típicamente al inicio de la función `main`.

### `rand()`: Generar el Número

`int rand(void);`

- Cada vez que se llama, `rand()` devuelve el siguiente número entero en la secuencia pseudoaleatoria.
- El valor devuelto es un entero entre `0` y `RAND_MAX`, una constante definida en `<stdlib.h>` (su valor mínimo garantizado es 32767, pero suele ser mayor).

## Ejemplo: Lanzar un Dado

Para obtener un número dentro de un rango específico (por ejemplo, de 1 a 6 para un dado), se utiliza el operador módulo (`%`).

`int resultado = (rand() % RANGO) + INICIO;`

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h> // Necesario para time()

int main() {
    // 1. Inicializar la semilla con la hora actual.
    //    Esto se hace solo UNA VEZ.
    srand(time(NULL));

    printf("Lanzando un dado de 6 caras 10 veces:\n");

    for (int i = 0; i < 10; i++) {
        // 2. Generar un número entre 0 y 5 (rand() % 6)
        // 3. Sumar 1 para obtener un rango de 1 a 6
        int dado = (rand() % 6) + 1;
        printf("%d ", dado);
    }
    printf("\n");

    printf("\nGenerando un número aleatorio entre 50 y 100:\n");
    // Rango: (100 - 50 + 1) = 51
    // Inicio: 50
    int numero_rango = (rand() % 51) + 50;
    printf("%d\n", numero_rango);

    return 0;
}
```

**¿Qué pasa si no llamas a `srand()`?**
Si omites la llamada a `srand()`, es como si el programa llamara a `srand(1)` por defecto. Esto significa que cada vez que ejecutes el programa, `rand()` producirá exactamente la misma secuencia de números, lo cual es útil para depuración, pero no para un comportamiento aleatorio real.

## Comparación con JavaScript

El enfoque de JavaScript es más simple y de más alto nivel.

| Característica               | C (`<stdlib.h>`)                                                       | JavaScript (`Math.random()`)                                                                                                                                 |
| :--------------------------- | :--------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Función Principal**        | `rand()`                                                               | `Math.random()`                                                                                                                                              |
| **Rango de Salida**          | Devuelve un entero entre `0` y `RAND_MAX`.                             | Devuelve un número de punto flotante entre `0` (inclusivo) y `1` (exclusivo).                                                                                |
| **Inicialización (Semilla)** | **Manual y explícita** con `srand()`. El programador tiene el control. | **Automática e implícita**. El motor de JS se encarga de inicializar el generador con una semilla de alta entropía. No hay control directo sobre la semilla. |
| **Obtener un Rango**         | `(rand() % RANGO) + INICIO`                                            | `Math.floor(Math.random() * RANGO) + INICIO`                                                                                                                 |

**Ejemplo en JavaScript (lanzar un dado):**

```javascript
// No se necesita inicialización de semilla.

console.log("Lanzando un dado de 6 caras 10 veces:");

for (let i = 0; i < 10; i++) {
  // Math.random() -> [0, 1)
  // Math.random() * 6 -> [0, 6)
  // Math.floor(...) -> 0, 1, 2, 3, 4, 5
  // ... + 1 -> 1, 2, 3, 4, 5, 6
  const dado = Math.floor(Math.random() * 6) + 1;
  console.log(dado);
}
```

## Limitaciones de `rand()`

El generador `rand()` estándar de C es simple y rápido, pero no es adecuado para aplicaciones que requieren alta calidad estadística o seguridad criptográfica.

- **Calidad Estadística**: En algunos sistemas, los bits de orden bajo de `rand()` pueden tener patrones no muy aleatorios. Por eso, a veces se prefiere `(int)((double)rand() / (RAND_MAX + 1.0) * RANGO)` en lugar del módulo.
- **Criptografía**: **Nunca uses `rand()` para generar claves, tokens o cualquier valor que deba ser criptográficamente seguro.** Para eso, se deben usar bibliotecas especializadas (como OpenSSL) que proporcionan generadores de números aleatorios criptográficamente seguros (CSPRNG).

## Resumen

- `srand()` y `rand()` son las herramientas estándar de C para la generación de números pseudoaleatorios.
- Es crucial llamar a `srand()` una sola vez con una semilla variable (como `time(NULL)`) para obtener secuencias diferentes en cada ejecución.
- El modelo de C da al programador control sobre la semilla, a diferencia de `Math.random()` de JavaScript, que lo abstrae por completo.
- Para necesidades avanzadas (estadística de alta calidad, criptografía), `rand()` no es suficiente y se deben usar bibliotecas más robustas.
